[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "County Business Patterns in North Carolina 2001-2021",
    "section": "",
    "text": "What is the “shape” of employment in North Carolina, and how has it changed over the last two decades? The US Census County Business Patterns (CBP) provides data that helps to answer these questions.\nSources and processing of the data:\nThe CBP includes and excludes the following:\nAt the time of writing (June 2023) the latest available data is for 2021. I downloaded county-level datasets for the 21 years 2001 - 2021 from https://www.census.gov/programs-surveys/cbp/data/datasets.html .\nThe data include number of establishments in various size categories, number of workers, and average salary. The CBP uses the North American Industry Classification System (NAICS), which in its detailed categories change over time. I limit my use to sector totals by county, which are more comparable through this time period. The sector totals are also much less sensitive to changes the US Census staff make in the data preparation process, notably withholding data or adding noise so that data from individual firms are not identifiable.\nI use the terms employment, employees, and workers interchangeably. Where I calculate summary average wages, I use weighted means. NAICS sector categories and abbreviations I created are listed in Section 1.6."
  },
  {
    "objectID": "index.html#acknowledgements",
    "href": "index.html#acknowledgements",
    "title": "County Business Patterns in North Carolina 2001-2021",
    "section": "Acknowledgements",
    "text": "Acknowledgements\nSpecial thanks to the US Census staff for producing high-quality data over long time periods. Also shout-out to Jeremy Singer-Vines for highlighting this data in his Data is Plural newsletter 2023.05.31 edition. Photo of Welcome to North Carolina sign uploaded to Flickr by WashuOtaku. Unmodified and used by permission ( Attribution-ShareAlike 2.0 Generic (CC BY-SA 2.0) )."
  },
  {
    "objectID": "cbp-employment-wages.html#nc-employment-by-sector",
    "href": "cbp-employment-wages.html#nc-employment-by-sector",
    "title": "1  Employment and average wages",
    "section": "1.1 NC employment by sector",
    "text": "1.1 NC employment by sector\nIn the state-level data for 2021 the CBP reported 3,903,814 workers in 20 NAICS categories, which are summarized in Section 1.6.\n\n\nShow the code\ndata_for_plot <- d_emp_sector_total_state_nc |>\n  filter(year == 2021) |>\n  mutate(naics_abbr = fct_reorder(naics_abbr, emp)) \n\nnc_naics_abbr_levels = levels(data_for_plot$naics_abbr)\n\ndata_for_plot |>\n  ggplot() +\n  geom_col(aes(x = emp, y = naics_abbr),\n           fill = carolina_blue, alpha = 0.6) +\n  scale_x_continuous(labels = label_number(scale_cut = cut_short_scale())) +\n  labs(\n    title = \"NC state employment by sector 2021\",\n    subtitle = \"Includes all 100 counties and 'Statewide'\",\n    x = \"Employees\",\n    y = \"\",\n    color = NULL,\n    caption = my_caption\n  )\n\n\n\n\n\nFigure 1.1: NC state employment by sector 2021\n\n\n\n\n\nThe employment distribution across the sectors in NC and the USA overall is similar:\n\n\nShow the code\ndata_for_plot <- bind_rows(\n  d_emp_sector_total_state_nc |>\n    filter(year == 2021) |>\n    mutate(scope = \"nc\"),\n  d_emp_sector_total_usa |>\n    filter(year == 2021) |>\n    mutate(scope = \"usa\")\n) |>\n  select(naics, naics_abbr, emp, pct_emp, scope) |>\n  mutate(naics_abbr = factor(naics_abbr, levels = nc_naics_abbr_levels)) |>\n  mutate(low_value = min(pct_emp),\n         high_value = max(pct_emp),\n         .by = naics_abbr) |>\n  mutate(diff_pct = high_value - low_value,\n         diff_pct = if_else(pct_emp == high_value, diff_pct, -1 * diff_pct)) \n\ndiff_pct_cutoff <- 0.005\n\ndata_for_plot |>\n  ggplot() +\n  geom_segment(aes(x = low_value, xend = high_value, y = naics_abbr, yend = naics_abbr),\n               alpha = 0.3) +\n  geom_point(aes(x = pct_emp, y = naics_abbr, color = scope),\n           alpha = 0.6) + \n  geom_point(aes(x = pct_emp, y = naics_abbr, color = scope),\n           alpha = 0.6) + \n  geom_text(aes(x = high_value, y = naics_abbr,\n                label = if_else(diff_pct > diff_pct_cutoff,\n                                percent(pct_emp, accuracy = .1),\n                                NA_character_)),\n            na.rm = TRUE, size = 3,\n            hjust = 0, nudge_x = 0.003) +\n  geom_text(aes(x = low_value, y = naics_abbr,\n                label = if_else(diff_pct < -1 * diff_pct_cutoff,\n                                percent(pct_emp, accuracy = .1),\n                                NA_character_)),\n            na.rm = TRUE, size = 3,\n            hjust = 1, nudge_x = -0.003) +\n  scale_x_continuous(labels = label_percent()) +\n  scale_color_manual(values = c(carolina_blue, \"firebrick\")) +\n  theme(legend.position = c(0.8, 0.4),\n        legend.box.background = element_rect(fill = \"grey80\")) +\n  labs(\n    title = \"NC state employment by sector\\ncompared to USA 2021\",\n    subtitle = glue(\"Includes all 100 counties and 'Statewide'\", \n                    \"; showing percentages where difference is > {percent(diff_pct_cutoff, accuracy = 0.1)}\"),\n    x = \"Employees\",\n    y = \"\",\n    color = NULL,\n    caption = my_caption\n  )\n\n\n\n\n\nFigure 1.2: NC employment by sector compared to USA 2021\n\n\n\n\n\nThe CBP state data includes employee counts categorized by employee size class. The range is embedded in the name. For example, e1_4 includes a count of employees working in establishments with 1-4 employees. Let’s assume that the average number of workers in each employment size class is about the midpoint of the class, and for e1000 (“1000 or more employees) that the midpoint is 2000.\nThen we can answer the question: from the perspective of workers, what are the most common employer size classes? Or asking another way: if one randomly selected a NC worker what is the probability the person would work in an establishment of a particular size class?\n\n\nShow the code\ndata_for_plot <- d_emp_state_nc_total_size_classes |>\n  filter(year == 2021) |>\n  inner_join(n_employees_ref |>\n               select(-est_size_class),\n             by = \"emp_size_class\")\n\np1 <- data_for_plot |>\n  mutate(emp_size_class = fct_reorder(emp_size_class, factor_order)) |>\n  ggplot() +\n  geom_col(aes(x = pct_emp, y = emp_size_class),\n           fill = carolina_blue, alpha = 0.6) +\n  scale_x_continuous(labels = label_percent()) +\n  scale_y_discrete(limits=rev) +\n  labs(\n    x = \"Percent of employees\",\n    y = \"Employee size class\",\n    color = NULL,\n  )\n\np2 <- data_for_plot |>\n  mutate(emp_size_class = fct_reorder(emp_size_class, pct_emp)) |>\n  arrange(desc(emp_size_class)) |>\n  mutate(cum_pct_emp = cumsum(pct_emp),\n         ybar_start = lag(cum_pct_emp, default = 0)) |>\n  ggplot() +\n  geom_segment(aes(x = emp_size_class, xend = emp_size_class, y = ybar_start, yend = cum_pct_emp),\n           color = carolina_blue, linewidth = 8, alpha = 0.6) + \n  scale_y_continuous(labels = label_percent()) +\n  scale_x_discrete(limits=rev) +\n  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +\n  labs(\n    x = \"Employee size class\",\n    y = \"Percent of employees\",\n    color = NULL,\n  )\n\np1 + p2 +\n  plot_annotation(\n    title = \"Percent of NC employees working for establishments\\nin each employee size class\",\n    subtitle = \"2021; includes all sectors reported in CBP\",\n    caption = my_caption,\n    #theme = theme(plot.title = element_text(size = 16))\n  )\n\n\n\n\n\nFigure 1.3: NC workers in each employee size class 2021\n\n\n\n\n\nFurther categorizing this data by industry sector reveals which industries have concentrations of workers in establishments of particular size classes. Employees in AccFood mostly work in establishments in the 10 to 100 employee range. In Retail there is a wider range: from very small to 499 employees and almost none larger. The industry sectors with the largest portion of employees working for the largest establishments are HeathSoc (hospital systems, I assume) and FinIns. Construction and ProfSciTech have the largest portion of employees in the sector working in 1-4 employee establishments.\n\n\nShow the code\ndata_for_plot <- d_emp_state_nc_size_classes |>\n  filter(year == 2021) |>\n  inner_join(n_employees_ref |>\n               select(-est_size_class),\n             by = \"emp_size_class\") |>\n  mutate(emp_size_class = factor(emp_size_class, levels = emp_size_class_levels),\n         naics_abbr = fct_lump(naics_abbr, n = 9, w = emp)) \n\np1 <- data_for_plot |>\n  ggplot() +\n  geom_col(aes(x = pct_emp, y = emp_size_class, fill = naics_abbr),\n           alpha = 0.6, show.legend = FALSE) +\n  scale_x_continuous(labels = label_percent(accuracy = 1)) +\n  scale_y_discrete(limits=rev) +\n  labs(\n    x = \"Percent of employees\",\n    y = \"Employee size class\",\n    color = NULL\n  )\n\np2 <- data_for_plot |>\n  ggplot() +\n  geom_col(aes(x = pct_emp, y = emp_size_class, fill = naics_abbr),\n           alpha = 0.6, position = position_fill()) +\n  scale_x_continuous(labels = label_percent(accuracy = 1)) +\n  scale_y_discrete(limits=rev) +\n  labs(\n    x = \"Distibution of size classes\",\n    y = NULL,\n    color = NULL\n  )\n\np3 <- data_for_plot |>\n  mutate(naics_abbr = fct_reorder(naics_abbr, emp, sum)) |>\n  ggplot() +\n  geom_col(aes(x = pct_emp, y = naics_abbr, fill = emp_size_class),\n           alpha = 0.6, show.legend = FALSE) +\n  scale_x_continuous(labels = label_percent(accuracy = 1)) +\n  scale_fill_viridis_d(end = 0.85) +\n  labs(\n    x = \"Percent of employees\",\n    y = NULL,\n    color = NULL\n  )\n\np4 <- data_for_plot |>\n  mutate(naics_abbr = fct_reorder(naics_abbr, emp, sum)) |> \n  ggplot() +\n  geom_col(aes(x = pct_emp, y = naics_abbr, fill = emp_size_class),\n           alpha = 0.6, position = position_fill()) +\n  scale_x_continuous(labels = label_percent(accuracy = 1)) +\n  scale_fill_viridis_d(end = 0.85) +\n  labs(\n    x = \"Distribution of NAICS categories\",\n    y = NULL,\n    color = NULL\n  )\n\n(p1 + p2) / (p3 + p4) +\n  plot_annotation(\n    title = \"Percent of NC workers in each employee size class by sector\",\n    subtitle = \"2021; includes all sectors reported in CBP\",\n    caption = my_caption\n  )\n\n\n\n\n\nFigure 1.4: Percent of NC workers in each employee size class by sector 2021"
  },
  {
    "objectID": "cbp-employment-wages.html#top-sectors-in-largest-nc-counties",
    "href": "cbp-employment-wages.html#top-sectors-in-largest-nc-counties",
    "title": "1  Employment and average wages",
    "section": "1.2 Top sectors in largest NC counties",
    "text": "1.2 Top sectors in largest NC counties\nAre there similarities in the top sectors and their proportions in the counties with the most workers? Yes. HealthSoc, Retail, and AccFood are among the top four sectors in each of the top nine counties and the “Statewide” category. There are some differences: Mecklenburg’s top sector is FinIns, Durham’s is ProfSciTec, and Catawba’s is Manuf.\n\n\nShow the code\ncounty_name_label <- d_emp_sector_total_county |> #d_sector_totals_county |>\n  filter(year == 2021) |>\n  select(year, fipscty, emp, county_name, naics) |>\n  summarize(emp_sum = sum(emp),\n            .by = county_name) |>\n  slice_max(order_by = emp_sum, n = 10) |>\n  mutate(county_name_label = glue(\"{county_name}\\n{comma(emp_sum)}\"),\n         county_name_label = fct_reorder(county_name_label, -emp_sum))\n\ndata_for_plot <- d_nc_2021_top5_sectors_county_nc |>\n  select(county_name, emp, naics, naics_descr, emp_rank) |>\n  left_join(d_naics_abbr_ref,\n             by = c(\"naics_descr\")) |>\n  left_join(county_name_label,\n             by = c(\"county_name\")) |>\n  mutate(pct_emp = emp / emp_sum,\n         county_name_label = fct_reorder(county_name_label, -emp, sum)) |>\n  complete(county_name_label, naics_abbr, fill = list(emp = NA, pct_emp = NA)) \n\ndata_for_plot |> \n  ggplot() +\n  geom_line(aes(x = county_name_label, y = pct_emp, group = naics_abbr, color = naics_abbr),\n            show.legend = FALSE, na.rm = TRUE) +\n  geom_label(aes(x = county_name_label, y = pct_emp, label = naics_abbr, fill = naics_abbr),\n             show.legend = FALSE, na.rm = TRUE, alpha = 0.4, size = data_label_size) +\n  scale_x_discrete(position = \"top\") +\n  scale_y_continuous(labels = label_percent()) +\n  coord_cartesian(ylim = c(NA, 0.30)) +\n  theme(axis.text.x = element_text(size = 10)) +\n  labs(\n    title = \"Top 5 sectors in 10 largest NC counties:\\npercent of county employment\",\n    subtitle = glue(\"Ordered by total county employment reported in CBP\",\n                    \"; 'Statewide' refers to employees not associated with one county\",\n                    \"\\nNot showing Statewide AdminWaste, since it's over 50% of all 'Statewide' employees\"),\n    x = \"\",\n    y = \"Percent of county employment\",\n    color = NULL,\n    caption = my_caption\n  )\n\n\n\n\n\nFigure 1.5: Sector percent of country emplyment rank\n\n\n\n\n\nThe same information is presented below with simple ranking:\n\n\nShow the code\ndata_for_plot |>\n  ggplot() +\n  geom_line(aes(x = county_name_label, y = emp_rank, group = naics_abbr, color = naics_abbr),\n            show.legend = FALSE, na.rm = TRUE) +\n  geom_label(aes(x = county_name_label, y = emp_rank, label = naics_abbr, fill = naics_abbr),\n             show.legend = FALSE, na.rm = TRUE, alpha = 0.4, size = data_label_size) +\n  scale_x_discrete(position = \"top\") +\n  scale_y_reverse() +\n  theme(axis.text.x = element_text(size = 10)) +\n  labs(\n    title = \"Top 5 sectors in 10 largest NC counties: ranking\",\n    subtitle = glue(\"Ordered by total county employment reported in CBP\",\n                    \"; 'Statewide' refers to workers not associated with one county\"),\n    x = \"\",\n    y = \"Rank in county employment\",\n    color = NULL,\n    caption = my_caption\n  )\n\n\n\n\n\nFigure 1.6: Sector rank by number of employees"
  },
  {
    "objectID": "cbp-employment-wages.html#trends-in-employment",
    "href": "cbp-employment-wages.html#trends-in-employment",
    "title": "1  Employment and average wages",
    "section": "1.3 Trends in employment",
    "text": "1.3 Trends in employment\nThe last two decades have brought significant changes in the number and mix of employees in NC. The financial crisis in 2008 and the following years caused significant job losses (and company closings see Figure 2.3), the trend overall has been upward, reflecting the growing population of the state.\n\n\nShow the code\nstate_emp_change <- d_emp_total_state_nc |>\n  mutate(emp_fist_year = emp[year == min(year)],\n         emp_last_year = emp[year == max(year)],\n         .by = c(\"naics\")) |>\n  mutate(pct_emp_diff = emp_last_year / emp_fist_year - 1) |>\n  distinct(emp_fist_year, emp_last_year, pct_emp_diff)\n\ndata_for_plot <- d_emp_total_state_nc |>\n  arrange(year) |>\n  mutate(pct_emp_diff_yty = emp / lag(emp) - 1)\n  \np1 <- data_for_plot |>\n  ggplot() +\n  geom_line(aes(x = year, y = emp, color = year),\n           linewidth = 1, alpha = 0.6, show.legend = FALSE) +\n  scale_y_continuous(labels = label_number(scale_cut = cut_short_scale())) +\n  guides(color = guide_legend(override.aes = c(linewidth = 3))) +\n   expand_limits(y = 0) +\n  labs(\n    subtitle = \"NC workers\",\n    x = \"\",\n    y = \"Number of employees\",\n    color = NULL,\n    caption = my_caption\n  )\n\np2 <- data_for_plot |>\n  ggplot(aes(year, pct_emp_diff_yty, color = year)) + #, color = year\n  geom_hline(yintercept = 0, lty = 2, linewidth = 0.2, alpha = 0.2) +\n  geom_line(linewidth = 1, alpha = 0.6, na.rm = TRUE, show.legend = FALSE) +\n  scale_y_continuous(labels = label_percent()) +\n  labs(\n    subtitle = glue(\"Change in percent employment year-to-year\"),\n    x = \"Employees in NC in 2021\",\n    y = \"Pct change yty\"\n    )\n\n(p1 + p2) +\n  plot_annotation(\n    title = \"NC workers 2001-2021\",\n    subtitle = glue(\"By 2021 employment was up {percent(state_emp_change$pct_emp_diff, accuracy = 0.1)}\",\n                    \" after more than losing all gains from the first decade in the aftermath of the 2008 financial crisis.\",\n                    \"\\nIncludes all sectors reported in CBP\"),\n    caption = my_caption\n  )\n\n\n\n\n\nFigure 1.7: NC workers 2001-2021\n\n\n\n\n\nThe sector-level dynamics have varied a lot. Compare Manuf with HealthSoc, for example:\n\n\nShow the code\ndata_for_plot <- d_emp_sector_total_state_nc |>\n  filter(naics_abbr != \"OtherInd\") |>\n  mutate(naics_abbr = fct_reorder(naics_abbr, -emp)\n         ) |>\n  mutate(emp_fist_year = emp[year == min(year)],\n         emp_last_year = emp[year == max(year)],\n         .by = c(\"naics\")) |>\n  mutate(pct_emp_diff = emp_last_year / emp_fist_year - 1)\n\nlabels_for_plot <- data_for_plot |>\n  filter(year == max(year))\n\np1 <- data_for_plot |>\n  filter(naics_abbr != \"Other\") |>\n  ggplot() +\n  geom_line(aes(x = year, y = emp, color = naics_abbr, group = naics_abbr),\n           linewidth = 0.4, alpha = 0.6, show.legend = FALSE) +\n  geom_text_repel(data = labels_for_plot,\n                  aes(x = year + 0.5, y = emp, label = naics_abbr, color = naics_abbr),\n                  direction = \"y\", hjust = 0, vjust = 0.5, size = 3,\n                  min.segment.length = unit(1, \"cm\"), force_pull = 100,\n                  seed = 123,\n                  show.legend = FALSE) +\n  scale_y_continuous(labels = label_number(scale_cut = cut_short_scale())) +\n  expand_limits(x = 2026,\n                y = 0) +\n  guides(color = guide_legend(override.aes = c(linewidth = 3))) +\n  labs(\n    subtitle = \"NC workers in each sector\",\n    x = \"\",\n    y = \"Number of employees\",\n    color = NULL,\n    caption = my_caption\n  )\n\np2 <- data_for_plot |>\n  filter(naics_abbr != \"Other\") |>\n  ggplot() +\n  geom_area(aes(x = year, y = emp, color = naics_abbr, fill = naics_abbr, group = naics_abbr),\n           linewidth = 0.4, alpha = 0.6, show.legend = FALSE) +\n  scale_y_continuous(labels = label_number(scale_cut = cut_short_scale()),\n                     expand = expansion(mult = c(0, 0.02))) +\n  expand_limits(y = 0) +\n  guides(color = guide_legend(override.aes = c(linewidth = 3))) +\n  labs(\n    subtitle = \"NC workers combined trend\",\n    x = \"\",\n    y = \"Number of employees\",\n    color = NULL,\n    caption = my_caption\n  )\n\np3 <- data_for_plot |>\n  filter(year == 2021,\n         emp != 0) |>\n  ggplot(aes(emp, pct_emp_diff, color = naics_abbr)) +\n  geom_hline(yintercept = 0, lty = 2, size = 0.2, alpha = 0.2) +\n  geom_label(aes(label = naics_abbr),\n             show.legend = FALSE, hjust = 0.5, vjust = 0.5) +\n  scale_x_continuous(labels = label_number(scale_cut = cut_short_scale())) +\n  scale_y_continuous(labels = label_percent()) +\n  labs(\n    subtitle = glue(\"What is the percent change in employment since 2001?\"),\n    x = \"Employees in NC in 2021\",\n    y = \"Pct change since 2001\"\n    )\n\n(p1 + p2) / p3 +\n  plot_annotation(\n    title = \"NC workers in each employee sector 2001-2021\",\n    subtitle = \"Includes all sectors reported in CBP\",\n    caption = my_caption\n  )\n\n\n\n\n\nFigure 1.8: NC workers in each sector 2001-2021\n\n\n\n\n\nThe portion of employees in each employee class size varies over time and across sectors. Decade-long trends are visible:\n\nThe share of employees in the Accommodation and Food sector has been increasing in most employee size classes, yet this sector suffered the most during the COVID-19 pandemic 2020-2021.\nThe share in Manufacturing has been in noticeable decline, especially through 2015 and in the larger employee size classes\nConstruction slowed significantly after the 2008 financial crisis.\n\nIn the HealthSoc, Retail, and ProfSciTec sectors there are cases of big changes from one year to the next in multiple employee size classes. I wonder if this is due to changes in NAICS categories, changes in measurement methodology, or a real change in that sector.\nNoise added to some data before release may be the cause of the jumpiness in some of the least common employee size classes.\n\n\nShow the code\ndata_for_plot <- d_emp_state_nc_size_classes |>\n  inner_join(n_employees_ref |>\n               select(-est_size_class),\n             by = \"emp_size_class\") |>\n  mutate(emp_size_class = factor(emp_size_class, levels = emp_size_class_levels),\n         naics_abbr = fct_lump(naics_abbr, n = 9, w = emp)) \n\ndata_for_plot |>\n  filter(naics_abbr != \"Other\") |>\n  ggplot() +\n  geom_line(aes(x = year, y = pct_emp, color = emp_size_class, group = emp_size_class),\n           linewidth = 0.4, alpha = 0.6) +\n  scale_y_continuous(labels = label_percent(accuracy = 0.1)) +\n  facet_wrap(. ~ naics_abbr, scales = \"free_y\") +\n  guides(color = guide_legend(override.aes = c(linewidth = 3))) +\n  labs(\n    title = \"Percent of NC workers in each employee size class\\nby sector 2001-2021\",\n    subtitle = \"Top 9 sectors by number of employees (in 2021) as reported in CBP\",\n    x = \"\",\n    y = \"Percent of employees (scale varies)\",\n    color = NULL,\n    caption = my_caption\n  )\n\n\n\n\n\nFigure 1.9: Percent of NC workers in each employee size class by sector\n\n\n\n\n\nThe year over year drop in manufacturing jobs through 2012 is striking. As is the consistent growth through the 21-year period in (1) Healthcare and social services and (2) Accommodation and food.\n\n\nShow the code\ndata_for_plot <- d_emp_sector_total_state_nc |>\n  inner_join(top_naics,\n             by = c(\"naics\", \"naics_abbr\")) |>\n  mutate(naics_abbr = fct_reorder(naics_abbr, emp))\n\ndata_for_plot |>\n  ggplot(aes(year, emp, color  = naics_abbr)) +\n  geom_point(size = 0.6, alpha = 0.4,\n            show.legend = FALSE) +\n  geom_labelsmooth(aes(label = naics_abbr,\n                       hjust = naics_sort_order / top_naics_cutoff - 0.1),\n                   method = 'loess', formula = 'y ~ x', span = 0.95,\n                   show.legend = FALSE) +\n  scale_y_continuous(labels = label_number(scale_cut = cut_short_scale()),\n                     expand = expansion(mult = c(0, 0.02))) +\n  scale_x_continuous(breaks = c(2001, 2011, 2021)) +\n  expand_limits(y = 0) +\n  guides(color = guide_legend(reverse = TRUE)) +\n  labs(\n    title = glue(\"NC employment trend:\\nTop {top_naics_cutoff} sectors\"),\n    x = \"\",\n    y = \"Number of employees\",\n    color = \"\",\n    caption = my_caption\n  )\n\n\n\n\n\nFigure 1.10: Employment trend: top 5 sectors by number of employees"
  },
  {
    "objectID": "cbp-employment-wages.html#trends-in-employment---counties",
    "href": "cbp-employment-wages.html#trends-in-employment---counties",
    "title": "1  Employment and average wages",
    "section": "1.4 Trends in employment - counties",
    "text": "1.4 Trends in employment - counties\nThere is naturally more variation when looking at the 100 counties rather than state summaries. The patterns are generally the same across counties of differing number of workers. I see two noticeable differences: (1) the largest counties are not in the group of the most extreme growth or decline; and (2) there is a group of ten or so mid-sized counties that declined modestly from 2001-2007, then quickly 2008-2009, and have grown slowly since then but still with lower employment than in 2001.\n\n\nShow the code\ndata_for_plot <- d_emp_total_county |>\n  filter(county_name != \"Statewide, NC\") |>\n  arrange(year) |>\n  mutate(pct_growth_since_2001 = emp / emp[year == min(year)],\n         pct_growth_full_period = pct_growth_since_2001[year == max(year)],\n         pct_emp_diff_yty = emp / lag(emp) - 1,\n         .by = c(fipscty)) |>\n  mutate(size_group = case_when(\n    emp < 1e4                ~ \"group 1: small\\nemp < 10K\",\n    emp < 1e5                ~ \"group 2: medium\\n10K < emp < 100K\",\n    emp >= 1e5               ~ \"group 3: large\\nemp > 100K\"\n  ))\n\nlabels_for_plot_tmp <- data_for_plot |>\n  filter(year == max(year)) \n\nlabels_for_plot <- bind_rows(\n  labels_for_plot_tmp |>\n    slice_max(order_by = pct_growth_full_period, n = 5),\n  labels_for_plot_tmp |>\n    slice_min(order_by = pct_growth_full_period, n = 5)\n)\n\nn_smaller <- data_for_plot |>\n  filter(year == max(year)) |>\n  filter(pct_growth_full_period < 1) |>\n  nrow()\n\np1 <- data_for_plot |>\n  ggplot() +\n  geom_hline(yintercept = 1, lty = 2, size = 0.2, alpha = 0.2) +\n  geom_line(aes(x = year, y = pct_growth_since_2001, group = county_name, color = pct_growth_full_period),\n            linewidth = 0.4, alpha = 0.6, show.legend = FALSE) +\n  geom_text_repel(data = labels_for_plot,\n                  aes(x = year + 0.5, y = pct_growth_full_period, label = county_name),\n                  direction = \"y\", hjust = 0, vjust = 0.5, size = 3,\n                  min.segment.length = unit(1, \"cm\"), force_pull = 100,\n                  seed = 123,\n                  show.legend = FALSE) +\n  scale_color_viridis_c(end = 0.85) +\n  expand_limits(x = 2027) +\n  labs(\n    subtitle = \"County growth trajectories - all counties\",\n    x = NULL,\n    y = \"Growth (2001 = 1)\"\n  )\n\np2 <- data_for_plot |>\n  ggplot() +\n  geom_hline(yintercept = 1, lty = 2, size = 0.2, alpha = 0.2) +\n  geom_line(aes(x = year, y = pct_growth_since_2001, group = county_name, color = pct_growth_full_period),\n            linewidth = 0.4, alpha = 0.6, show.legend = FALSE) +\n  geom_text_repel(data = labels_for_plot,\n                  aes(x = year + 0.5, y = pct_growth_full_period, label = county_name),\n                  direction = \"y\", hjust = 0, vjust = 0.5, size = 3,\n                  min.segment.length = unit(1, \"cm\"), force_pull = 100,\n                  seed = 123,\n                  show.legend = FALSE) +\n  scale_color_viridis_c(end = 0.85) +\n  facet_wrap( ~ size_group) +\n  expand_limits(x = 2027) +\n  labs(\n    subtitle = \"County growth trajectories - grouped by number of workers in the county\",\n    x = NULL,\n    y = \"Growth (2001 = 1)\"\n  )\n\np1 + p2 +\n    plot_layout(widths = c(1, 3)) +\n    plot_annotation(\n      title = \"County employee growth trajectories 2001-2021\",\n      subtitle = glue(\"{n_smaller} of 100 counties ended the period with fewer workers\", \n                      \"; as reported in CBP; excludes 'Statewide'\",\n                      \"; with names of counties with most growth and decline\"),\n      caption = my_caption\n    )\n\n\n\n\n\nFigure 1.11: NC state employees by county (percent) 2021-2021\n\n\n\n\n\nPlacing the county trends in their approximate geographic context, it’s noticeable that (1) growth or decline is not concentrated in one part of the state; (2) most of the workers are in a relatively small number of counties; and (3) most of the counties with more than 50K workers saw employment growth 2001-2021 (and plenty of counties with few workers saw employment growth too).\n\n\nShow the code\ndata_for_plot <- d_emp_total_county |>\n  filter(county_name != \"Statewide, NC\") |>\n  mutate(pct_growth_since_2001 = emp / emp[year == min(year)],\n         pct_growth_full_period = pct_growth_since_2001[year == max(year)],\n         .by = c(fipscty)) |>\n  mutate(county_name = if_else(county_name == \"McDowell\", \"Mcdowell\", county_name),\n         fill_color = if_else(pct_growth_full_period > 1, \"up\", \"down\"))\n\ndata_for_plot |>\n  ggplot() +\n  geom_rect(aes(xmin = min(year) - 1, xmax = max(year) + 1, \n                ymin = min(emp) - 0.05 * min(emp), ymax = max(emp) + 0.05 * max(emp),\n                fill = fill_color),\n            alpha = 0.01, show.legend = FALSE) +\n  geom_line(aes(x = year, y = emp), \n            show.legend = FALSE) +\n  scale_x_continuous(breaks = c(2001, 2011, 2021),\n                     expand = expansion(mult = c(0,0))) +\n  scale_y_continuous(breaks = c(0, 2e5, 4e5, 6e5),\n                     labels = label_number(scale_cut = cut_short_scale()),\n                     expand = expansion(mult = c(0.02,0))) +\n  scale_fill_viridis_d(end = 0.85) +\n  facet_geo( ~ county_name,\n             grid = \"us_nc_counties_grid1\") +\n  theme(panel.grid = element_blank(),\n        axis.title.y = element_text(hjust = 1),\n        axis.text.x = element_text(angle = 60, hjust = 1),\n        plot.title = element_text(size = rel(3.0), face = \"bold\"),\n        legend.position = \"top\") +\n  labs(title = \"Employment in NC counties 2001-2021\", \n       subtitle = glue(\"Green cells indicate higher employment at end of period\"),\n       x = NULL,\n       y = \"Number of workers\",\n       caption = my_caption)\n\n\n\n\n\nFigure 1.12: Employment trends in NC counties (approximate geographical position)\n\n\n\n\n\nLooking at change year-to-year for each county where 2001 employment equals 1, some patterns emerge: (1) counties with employment growth in this period tended to grow fast, declined during and after the financial crisis, then grew beyond their previous high water mark in the last decade; (2) some counties in decline lost workers nearly every year.\n\n\nShow the code\ndata_for_plot <- d_emp_total_county |>\n  filter(county_name != \"Statewide, NC\") |>\n  mutate(pct_growth_since_2001 = emp / emp[year == min(year)],\n         pct_growth_full_period = pct_growth_since_2001[year == max(year)],\n         .by = c(fipscty)) |>\n  mutate(county_name = if_else(county_name == \"McDowell\", \"Mcdowell\", county_name),\n         fill_color = if_else(pct_growth_full_period > 1, \"up\", \"down\"))\n\ndata_for_plot |>\n  ggplot() +\n  geom_rect(aes(xmin = min(year) - 1, xmax = max(year) + 1, \n                ymin = min(pct_growth_since_2001) - 0.05, ymax = max(pct_growth_since_2001) + 0.05,\n                fill = fill_color),\n            alpha = 0.01, show.legend = FALSE) +\n  geom_hline(yintercept = 1, lty = 2, size = 0.2, alpha = 0.3) +\n  geom_line(aes(x = year, y = pct_growth_since_2001), \n            show.legend = FALSE) +\n  scale_x_continuous(breaks = c(2001, 2011, 2021),\n                     expand = expansion(mult = c(0,0))) +\n  scale_y_continuous(labels = label_number(scale_cut = cut_short_scale()),\n                     expand = expansion(mult = c(0,0))) +\n  scale_fill_viridis_d(end = 0.85) +\n  facet_geo( ~ county_name,\n             grid = \"us_nc_counties_grid1\") +\n  theme(panel.grid = element_blank(),\n        axis.title.y = element_text(hjust = 1),\n        axis.text.x = element_text(angle = 60, hjust = 1),\n        plot.title = element_text(size = rel(3.0), face = \"bold\"),\n        legend.position = \"top\") +\n  labs(title = \"Year-to-year change in employment in NC counties 2001-2021\", \n       subtitle = glue(\"2001 = 1; green cells indicate higher employment at end of period\"),\n       x = NULL,\n       y = \"Change in employment\",\n       caption = my_caption)\n\n\n\n\n\nFigure 1.13: Employment trends in NC counties (approximate geographical position)\n\n\n\n\n\nThere is variation in the industry sectors, counties, and employee size classes.\n\n\nShow the code\ndata_for_plot <- d_emp_county_nc_size_classes |>\n  mutate(naics_abbr = fct_lump(naics_abbr, n = 8, w = pct_emp),\n         county_name = fct_lump(county_name, n = 10, w = emp),\n         county_name = fct_rev(county_name)) \n\ndata_for_plot |>\n  filter(naics_abbr != \"Other\",\n         county_name != \"Other\") |>\n  ggplot() +\n  geom_line(aes(x = year, y = pct_emp, color = emp_size_class, group = emp_size_class),\n           linewidth = 0.4, alpha = 0.6) +\n  scale_x_continuous(breaks = c(2001, 2011, 2021)) +\n  scale_y_continuous(labels = label_percent(accuracy = 0.1)) +\n  facet_grid(county_name ~ naics_abbr, scales = \"free_y\") +\n  theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)) +\n  guides(color = guide_legend(override.aes = c(linewidth = 3))) +\n  labs(\n    title = \"Percent of workers in each employee size class\\nby sector and county 2001-2021\",\n    subtitle = \"Top 8 sectors in largest 10 largest counties by employment (in 2021) as reported in CBP\",\n    x = \"\",\n    y = \"Percent of employees (scale varies by row)\",\n    color = NULL,\n    caption = my_caption\n  )\n\n\n\n\n\nFigure 1.14: NC state employees by establishment size class and sector (percent) 2001-2021"
  },
  {
    "objectID": "cbp-employment-wages.html#trends-in-average-wages-statewide",
    "href": "cbp-employment-wages.html#trends-in-average-wages-statewide",
    "title": "1  Employment and average wages",
    "section": "1.5 Trends in average wages statewide",
    "text": "1.5 Trends in average wages statewide\nAverage wage trends are not uniform across sectors. Wages in four of the five highest paying sectors grew faster than inflation while they dropped in “Management”. I wonder if the drop in the average wage of the management sector is due to manufacturing and financial services disruptions set in motion by the 2008 financial crisis and the COVID-19 pandemic. Or perhaps managers are getting a smaller portion of their income in wages and more in stock or other benefits.\n\n\nShow the code\ntop_wage <- d_emp_sector_total_state_nc |>\n  filter(year == 2021) |>\n  slice_max(order_by = avg_wage, n = top_naics_cutoff) |>\n  mutate(wage_sort_order = row_number()) |>\n  select(naics, wage_sort_order)\n\ndata_for_plot <- d_emp_sector_total_state_nc |>\n  inner_join(top_wage,\n             by = \"naics\") |>\n  inner_join(d_infation_adj,\n             by = \"year\") |>\n  mutate(avg_wage_adjusted = avg_wage * adj)\n\ndata_for_plot |>\n  ggplot(aes(year, avg_wage_adjusted, color  = naics_abbr, group = naics_abbr)) +\n  geom_point(size = 0.6, alpha = 0.4,\n            show.legend = FALSE) +\n  geom_labelsmooth(aes(label = naics_abbr, \n                       hjust = wage_sort_order / top_naics_cutoff - 0.1),\n                   method = 'loess', formula = 'y ~ x', span = 0.95,\n                   show.legend = FALSE) +\n  scale_y_continuous(labels = label_number(scale_cut = cut_short_scale(),\n                                           prefix = \"$\"),\n                     expand = expansion(mult = c(0, 0.02))) +\n  scale_x_continuous(breaks = c(2001, 2011, 2021)) +\n  guides(color = guide_legend(reverse = TRUE)) +\n  expand_limits(y = 0) +\n  labs(\n    title = glue(\"NC average wage trend:\\nTop {top_naics_cutoff} sectors\"),\n    subtitle = glue(\"In 2021 dollars\"),\n    x = \"\",\n    y = \"\",\n    color = \"\",\n    caption = my_caption\n  )\n\n\n\n\n\nFigure 1.15: Wage trend: top 5 sectors by average wage in 2021\n\n\n\n\n\n\n\nShow the code\ndata_for_plot <- d_emp_sector_total_state_nc |>\n  inner_join(d_infation_adj,\n             by = \"year\") |>\n  mutate(avg_wage_adjusted = avg_wage * adj) |>\n  mutate(wage_fist_year = avg_wage_adjusted[year == min(year)],\n         wage_last_year = avg_wage_adjusted[year == max(year)],\n         .by = c(\"naics\")) |>\n  mutate(wage_diff = wage_last_year - wage_fist_year,\n         wage_direction = if_else(wage_diff > 0, \"wage up\", \"wage down\"),\n         pct_wage_diff = wage_last_year / wage_fist_year - 1)\n\nlabels_for_plot <- data_for_plot |>\n  filter(year == max(year))\n  \np1 <- data_for_plot |>\n  filter(emp != 0) |>\n  ggplot(aes(year, avg_wage_adjusted, color = naics_abbr)) +\n  geom_point(size = 1, alpha = 0.2, na.rm = TRUE,\n             show.legend = FALSE) +\n  geom_smooth(method = 'loess', formula = 'y ~ x',\n              #span = 3,\n              se = FALSE, show.legend = FALSE) +\n  geom_text_repel(data = labels_for_plot,\n                  aes(x = year + 0.5, y = avg_wage_adjusted, label = naics_abbr),\n                  direction = \"y\", hjust = 0, vjust = 0.5, size = 3,\n                  min.segment.length = unit(1, \"cm\"), force_pull = 100,\n                  seed = 123,\n                  show.legend = FALSE) +\n  scale_y_continuous(labels = label_number(scale_cut = cut_short_scale(),\n                                           prefix = \"$\"),\n                     expand = expansion(mult = c(0, 0.02))) +\n  expand_limits(x = 2026,\n                y = 0) +\n  facet_wrap(~ wage_direction) +\n  labs(\n    subtitle = \"NC average wage trend in 2021 up or down compared to 2001\",\n    x = NULL,\n    y = \"Average wages\"\n  )\n\np2 <- data_for_plot |>\n  filter(year == 2021,\n         emp != 0) |>\n  ggplot(aes(emp, pct_wage_diff, color = naics_abbr)) +\n  geom_hline(yintercept = 0, lty = 2, size = 0.2, alpha = 0.2) +\n  geom_label(aes(label = naics_abbr),\n             show.legend = FALSE, hjust = 0.5, vjust = 0.5) +\n  scale_x_continuous(labels = label_number(scale_cut = cut_short_scale())) +\n  scale_y_continuous(labels = label_percent()) +\n  labs(\n    subtitle = glue(\"Percent change in average wages since 2001\"),\n    x = \"Employees in NC in 2021\",\n    y = \"Percent change in average wage since 2001\"\n    )\n\np1 / p2 +\n  plot_annotation(\n    title = \"Average wages by sector 2001-2021\",\n    subtitle = \"In 2021 dollars; includes all sectors reported in CBP\",\n    caption = my_caption\n  )\n\n\n\n\n\nFigure 1.16: NC average wage trend by sector 2001-2021\n\n\n\n\n\nThere is a lot of wage variation in subcategories based on job role and location. Consider “Health and social services” (HealthSoc):\n\n\nShow the code\ndata_for_plot <- d_emp_county_healthsoc |>\n  filter(emp >= 10,\n         !str_detect(naics, \"/$|-$\")) |> # only the most detailed categories\n  mutate(naics_descr = fct_lump(naics_descr, 20)) |>\n  filter(naics_descr != \"Other\") |>\n  inner_join(d_infation_adj,\n             by = \"year\") |>\n  mutate(avg_wage_adjusted = avg_wage * adj) |>\n  filter(!is.na(avg_wage_adjusted))\n\nave_wage_detailed_naics <- data_for_plot |>\n  summarize(avg_wage = weighted.mean(avg_wage_adjusted, w = emp),\n         .by = c(naics, naics_descr))\n\nn_datapoints <- nrow(data_for_plot)\n  \np1 <- data_for_plot |>\n  mutate(naics_descr = fct_reorder(naics_descr, avg_wage, mean)) |>\n  ggplot(aes(avg_wage, naics_descr, fill = naics_descr)) +\n  geom_violin(linewidth = 0.2, alpha = 0.7, show.legend = FALSE) + #fill = carolina_blue, \n  geom_point(data = ave_wage_detailed_naics,\n             aes(avg_wage, naics_descr),\n             shape = \"|\", size = 4, show.legend = FALSE) +\n  scale_x_continuous(labels = label_number(scale_cut = cut_short_scale(),\n                                           prefix = \"$\"),\n                     expand = expansion(mult = c(0, 0.02))) +\n  labs(\n    subtitle = glue(\"Average wage in HealthSoc varies widely\"),\n    x = \"Distribution of avg wages\\nvertical bar at mean\",\n    y = NULL,\n  )\n\np2 <- data_for_plot |>\n  mutate(naics_descr = fct_reorder(naics_descr, avg_wage, mean)) |>\n  ggplot(aes(emp, avg_wage, group = naics_descr, color = naics_descr)) +\n  geom_smooth(span = 0.97, method = 'loess', formula = 'y ~ x',\n              se = FALSE, show.legend = FALSE,\n              linewidth = 0.6, alpha = 0.4) +\n  scale_x_log10(labels = label_number(scale_cut = cut_short_scale())) +\n  scale_y_continuous(labels = label_number(scale_cut = cut_short_scale(),\n                                           prefix = \"$\")) +\n  labs(\n    subtitle = glue(\"Average wages generally are higher\\nin counties with more workers\"),\n    x = \"Employees (log10 scale)\",\n    y = \"Avg sector wage\",\n    y = NULL\n    )\n\np1 + p2 +\n  plot_annotation(\n    title = \"HealthSoc in NC 2001-2021\",\n    subtitle = glue(\"In 2021 dollars; includes data where [year, county, naics] employee count ≥ 10 in at least 20 of the 100 NC counties\", \n                    \"\\nMost detailed NAICS categories only; N = {comma(n_datapoints)}\"),\n    caption = my_caption\n  )\n\n\n\n\n\nFigure 1.17: NC average wages in HealthSoc sector"
  },
  {
    "objectID": "cbp-employment-wages.html#sec-tables",
    "href": "cbp-employment-wages.html#sec-tables",
    "title": "1  Employment and average wages",
    "section": "1.6 Tables",
    "text": "1.6 Tables\nBelow are the sector summary categories used in the CBP. To simplify plotting, I created some abbreviations:\n\n\nShow the code\nd_naics_abbr_ref |>\n  arrange(naics_abbr_num) |>\n  select(naics_abbr, naics_descr) |>\n  mutate(rowid = row_number()) |>\n  gt() |>\n  tab_header(md(glue(\"**NAICS categories and abbreviations used in this analysis**\"))) |>\n  tab_source_note(md(\"*US Census County Business Patterns; analysis by Daniel Moul*\")) |>\n  tab_options(table.font.size = 10)\n\n\n\n\n\n\nTable 1.1:  NAICS sector categories and abbreviations \n  \n    \n      NAICS categories and abbreviations used in this analysis\n    \n    \n    \n      naics_abbr\n      naics_descr\n      rowid\n    \n  \n  \n    TotalAllSec\nTotal for all sectors\n1\n    AccFood\nAccommodation and food services\n2\n    AdminWaste\nAdministrative and support and waste management and remediation services\n3\n    AgForFish\nAgriculture, forestry, fishing and hunting\n4\n    ArtEntRec\nArts, entertainment, and recreation\n5\n    Constr\nConstruction\n6\n    Educ\nEducational services\n7\n    FinIns\nFinance and insurance\n8\n    HealthSoc\nHealth care and social assistance\n9\n    Info\nInformation\n10\n    Manuf\nManufacturing\n11\n    MineOilGas\nMining, quarrying, and oil and gas extraction\n12\n    Mgmt\nManagement of companies and enterprises\n13\n    ProfSciTec\nProfessional, scientific, and technical services\n14\n    RealEst\nReal estate and rental and leasing\n15\n    Retail\nRetail trade\n16\n    Transpt\nTransportation and warehousing\n17\n    Util\nUtilities\n18\n    Whlsale\nWholesale trade\n19\n    OtherServ\nOther services (except public administration)\n20\n    OtherInd\nIndustries not classified\n21\n  \n  \n    \n      US Census County Business Patterns; analysis by Daniel Moul\n    \n  \n  \n\n\n\n\n\n\nSectors sorted by number of employees:\n\n\nShow the code\nd_emp_sector_total_state_nc |>\n  filter(year == 2021) |>\n  filter(naics_abbr != \"OtherInd\") |>\n  select(naics, naics_abbr, naics_descr, emp_2021 = emp, pct_emp_2021 = pct_emp) |>\n  arrange(-emp_2021) |>\n  mutate(rowid = row_number()) |>\n  relocate(naics_descr, .after = naics) |>\n  gt() |>\n  tab_header(md(glue(\"**NC sector employment 2021**\",\n                     \"<br>*Sorted by sector employment*\"))) |>\n  tab_source_note(md(\"*US Census County Business Patterns; analysis by Daniel Moul*\")) |>\n  tab_options(table.font.size = 10) |>\n  fmt_number(columns = c(emp_2021), #, avg_wage\n             decimals = 0) |>\n  fmt_percent(columns = pct_emp_2021, \n             decimals = 0)\n\n\n\n\n\n\nTable 1.2:  NC state employment by sector 2021 \n  \n    \n      NC sector employment 2021Sorted by sector employment\n    \n    \n    \n      naics\n      naics_descr\n      naics_abbr\n      emp_2021\n      pct_emp_2021\n      rowid\n    \n  \n  \n    62----\nHealth care and social assistance\nHealthSoc\n625,672\n16%\n1\n    44----\nRetail trade\nRetail\n512,706\n13%\n2\n    31----\nManufacturing\nManuf\n451,487\n12%\n3\n    72----\nAccommodation and food services\nAccFood\n402,561\n10%\n4\n    56----\nAdministrative and support and waste management and remediation services\nAdminWaste\n290,845\n7%\n5\n    54----\nProfessional, scientific, and technical services\nProfSciTec\n245,485\n6%\n6\n    23----\nConstruction\nConstr\n228,752\n6%\n7\n    52----\nFinance and insurance\nFinIns\n212,324\n5%\n8\n    42----\nWholesale trade\nWhlsale\n191,495\n5%\n9\n    48----\nTransportation and warehousing\nTranspt\n159,091\n4%\n10\n    81----\nOther services (except public administration)\nOtherServ\n156,834\n4%\n11\n    55----\nManagement of companies and enterprises\nMgmt\n99,410\n3%\n12\n    61----\nEducational services\nEduc\n98,677\n3%\n13\n    51----\nInformation\nInfo\n86,053\n2%\n14\n    53----\nReal estate and rental and leasing\nRealEst\n58,890\n2%\n15\n    71----\nArts, entertainment, and recreation\nArtEntRec\n54,515\n1%\n16\n    22----\nUtilities\nUtil\n20,391\n1%\n17\n    11----\nAgriculture, forestry, fishing and hunting\nAgForFish\n4,714\n0%\n18\n    21----\nMining, quarrying, and oil and gas extraction\nMineOilGas\n3,464\n0%\n19\n  \n  \n    \n      US Census County Business Patterns; analysis by Daniel Moul\n    \n  \n  \n\n\n\n\n\n\nSorted by percent difference from 2001 to 2021\n\n\nShow the code\nd_emp_sector_total_state_nc |>\n  filter(naics_abbr != \"OtherInd\") |>\n  mutate(naics_abbr = fct_reorder(naics_abbr, -emp)\n         ) |>\n  mutate(emp_fist_year = emp[year == min(year)],\n         emp_last_year = emp[year == max(year)],\n         .by = c(\"naics\")) |>\n  mutate(pct_emp_diff = emp_last_year / emp_fist_year - 1) |>\n  filter(year == 2021) |>\n  select(naics, naics_abbr, emp_2021 = emp, pct_emp_2021 = pct_emp, pct_emp_diff_since_2001 = pct_emp_diff) |>\n  arrange(-pct_emp_diff_since_2001) |>\n  mutate(rowid = row_number()) |>\n  gt() |>\n  tab_header(md(glue(\"**NC sector employment in 2021 and growth since 2001**\",\n                     \"<br>*Sorted by growth since 2001*\"))) |>\n  tab_source_note(md(\"*US Census County Business Patterns; analysis by Daniel Moul*\")) |>\n  tab_options(table.font.size = 10) |>\n  fmt_number(columns = c(emp_2021),\n             decimals = 0) |>\n  fmt_percent(columns = c(pct_emp_2021, pct_emp_diff_since_2001),\n             decimals = 0)\n\n\n\n\n\n\nTable 1.3:  NC state employment growth by sector 2001-2021 \n  \n    \n      NC sector employment in 2021 and growth since 2001Sorted by growth since 2001\n    \n    \n    \n      naics\n      naics_abbr\n      emp_2021\n      pct_emp_2021\n      pct_emp_diff_since_2001\n      rowid\n    \n  \n  \n    48----\nTranspt\n159,091\n4%\n59%\n1\n    54----\nProfSciTec\n245,485\n6%\n55%\n2\n    62----\nHealthSoc\n625,672\n16%\n52%\n3\n    61----\nEduc\n98,677\n3%\n46%\n4\n    72----\nAccFood\n402,561\n10%\n43%\n5\n    56----\nAdminWaste\n290,845\n7%\n24%\n6\n    71----\nArtEntRec\n54,515\n1%\n24%\n7\n    55----\nMgmt\n99,410\n3%\n23%\n8\n    53----\nRealEst\n58,890\n2%\n21%\n9\n    44----\nRetail\n512,706\n13%\n16%\n10\n    52----\nFinIns\n212,324\n5%\n14%\n11\n    42----\nWhlsale\n191,495\n5%\n11%\n12\n    51----\nInfo\n86,053\n2%\n8%\n13\n    22----\nUtil\n20,391\n1%\n8%\n14\n    81----\nOtherServ\n156,834\n4%\n6%\n15\n    23----\nConstr\n228,752\n6%\n1%\n16\n    21----\nMineOilGas\n3,464\n0%\n−1%\n17\n    11----\nAgForFish\n4,714\n0%\n−23%\n18\n    31----\nManuf\n451,487\n12%\n−35%\n19\n  \n  \n    \n      US Census County Business Patterns; analysis by Daniel Moul\n    \n  \n  \n\n\n\n\n\nSorted by average wage:\n\n\nShow the code\nd_emp_sector_total_state_nc |>\n  filter(year == 2021) |>\n  select(naics, naics_abbr, avg_wage_2021 = avg_wage, emp_2021 = emp, pct_emp_2021 = pct_emp) |>\n  arrange(-avg_wage_2021) |>\n  mutate(rowid = row_number()) |>\n  gt() |>\n  tab_header(md(glue(\"**NC sector employment 2021**\",\n                     \"<br>*Sorted by sector average wage*\"))) |>\n  tab_source_note(md(\"*US Census County Business Patterns; analysis by Daniel Moul*\")) |>\n  tab_options(table.font.size = 10) |>\n  fmt_number(columns = c(emp_2021, avg_wage_2021),\n             decimals = 0) |>\n  fmt_percent(columns = pct_emp_2021, \n             decimals = 0)\n\n\n\n\n\n\nTable 1.4:  NC state average wage by sector 2021 \n  \n    \n      NC sector employment 2021Sorted by sector average wage\n    \n    \n    \n      naics\n      naics_abbr\n      avg_wage_2021\n      emp_2021\n      pct_emp_2021\n      rowid\n    \n  \n  \n    52----\nFinIns\n114,024\n212,324\n5%\n1\n    51----\nInfo\n112,154\n86,053\n2%\n2\n    22----\nUtil\n108,108\n20,391\n1%\n3\n    55----\nMgmt\n104,025\n99,410\n3%\n4\n    54----\nProfSciTec\n90,430\n245,485\n6%\n5\n    42----\nWhlsale\n82,657\n191,495\n5%\n6\n    21----\nMineOilGas\n73,410\n3,464\n0%\n7\n    23----\nConstr\n59,089\n228,752\n6%\n8\n    53----\nRealEst\n58,796\n58,890\n2%\n9\n    31----\nManuf\n58,104\n451,487\n12%\n10\n    62----\nHealthSoc\n56,471\n625,672\n16%\n11\n    61----\nEduc\n49,027\n98,677\n3%\n12\n    48----\nTranspt\n48,231\n159,091\n4%\n13\n    11----\nAgForFish\n45,136\n4,714\n0%\n14\n    56----\nAdminWaste\n42,286\n290,845\n7%\n15\n    71----\nArtEntRec\n40,880\n54,515\n1%\n16\n    81----\nOtherServ\n34,543\n156,834\n4%\n17\n    44----\nRetail\n30,474\n512,706\n13%\n18\n    99----\nOtherInd\n25,248\n448\n0%\n19\n    72----\nAccFood\n20,614\n402,561\n10%\n20\n  \n  \n    \n      US Census County Business Patterns; analysis by Daniel Moul\n    \n  \n  \n\n\n\n\n\n\n\n\nShow the code\nd_emp_sector_total_state_nc |>\n  inner_join(d_infation_adj,\n             by = \"year\") |>\n  mutate(avg_wage_adjusted = avg_wage * adj) |>\n  mutate(wage_fist_year = avg_wage_adjusted[year == min(year)],\n         wage_last_year = avg_wage_adjusted[year == max(year)],\n         .by = c(\"naics\")) |>\n  mutate(wage_diff = wage_last_year - wage_fist_year,\n         pct_wage_diff = wage_last_year / wage_fist_year - 1) |>\n  filter(year == 2021) |>\n  select(naics, naics_abbr, avg_wage_2021 = wage_last_year, pct_avg_wage_diff_since_2001 = pct_wage_diff, \n         emp_2021 = emp, pct_emp_2021 = pct_emp) |>\n  arrange(-pct_avg_wage_diff_since_2001) |>\n  mutate(rowid = row_number()) |>\n  gt() |>\n  tab_header(md(glue(\"**NC sector average wage 2021 and difference since 2001**\",\n                     \"<br>*Sorted by average wage difference*\"))) |>\n  tab_source_note(md(\"*US Census County Business Patterns; analysis by Daniel Moul*\")) |>\n  tab_options(table.font.size = 10) |>\n  fmt_number(columns = c(avg_wage_2021, emp_2021),\n             decimals = 0) |>\n  fmt_percent(columns = c(pct_avg_wage_diff_since_2001, pct_emp_2021), \n             decimals = 0)\n\n\n\n\n\n\nTable 1.5:  NC state average wage growth by sector 2001-2021 \n  \n    \n      NC sector average wage 2021 and difference since 2001Sorted by average wage difference\n    \n    \n    \n      naics\n      naics_abbr\n      avg_wage_2021\n      pct_avg_wage_diff_since_2001\n      emp_2021\n      pct_emp_2021\n      rowid\n    \n  \n  \n    51----\nInfo\n112,154\n68%\n86,053\n2%\n1\n    52----\nFinIns\n114,024\n67%\n212,324\n5%\n2\n    56----\nAdminWaste\n42,286\n33%\n290,845\n7%\n3\n    54----\nProfSciTec\n90,430\n32%\n245,485\n6%\n4\n    42----\nWhlsale\n82,657\n29%\n191,495\n5%\n5\n    53----\nRealEst\n58,796\n28%\n58,890\n2%\n6\n    23----\nConstr\n59,089\n26%\n228,752\n6%\n7\n    11----\nAgForFish\n45,136\n25%\n4,714\n0%\n8\n    21----\nMineOilGas\n73,410\n22%\n3,464\n0%\n9\n    31----\nManuf\n58,104\n22%\n451,487\n12%\n10\n    61----\nEduc\n49,027\n21%\n98,677\n3%\n11\n    72----\nAccFood\n20,614\n20%\n402,561\n10%\n12\n    81----\nOtherServ\n34,543\n20%\n156,834\n4%\n13\n    22----\nUtil\n108,108\n17%\n20,391\n1%\n14\n    62----\nHealthSoc\n56,471\n17%\n625,672\n16%\n15\n    71----\nArtEntRec\n40,880\n9%\n54,515\n1%\n16\n    55----\nMgmt\n104,025\n7%\n99,410\n3%\n17\n    44----\nRetail\n30,474\n0%\n512,706\n13%\n18\n    48----\nTranspt\n48,231\n−6%\n159,091\n4%\n19\n    99----\nOtherInd\n25,248\n−20%\n448\n0%\n20\n  \n  \n    \n      US Census County Business Patterns; analysis by Daniel Moul"
  },
  {
    "objectID": "cbp-establishments.html#introduction",
    "href": "cbp-establishments.html#introduction",
    "title": "2  Establishments",
    "section": "2.1 Introduction",
    "text": "2.1 Introduction\nThe County Business Patterns data uses the general term establishment to refer to corporations, partnerships, non-profit organizations, etc.\nThe CBP data includes establishments categorized by employee size class. The range is embedded in the name. For example, n1_4 includes a count of establishments with 1-4 employees. The category n1000 includes establishments with 1,000 or more employees.\nThe plots below that reference sectors use the sector abbreviations listed in Section 1.6."
  },
  {
    "objectID": "cbp-establishments.html#number-of-establishments-in-nc",
    "href": "cbp-establishments.html#number-of-establishments-in-nc",
    "title": "2  Establishments",
    "section": "2.2 Number of establishments in NC",
    "text": "2.2 Number of establishments in NC\nAs one might expect, there are many more establishments with a small number of employees. Each subsequent employee size class includes fewer establishments. Compare the number of workers in each employee size class in Figure 1.3.\n\n\nShow the code\np1 <- d_est_state_nc_total_size_classes |> \n  filter(year == 2021) |>\n  ggplot() +\n  geom_col(aes(x = value, y = est_size_class),\n           fill = carolina_blue, alpha = 0.6) + \n  scale_x_continuous(labels = label_number(scale_cut = cut_short_scale())) +\n  scale_y_discrete(limits=rev) +\n  labs(\n    x = \"Establishments\",\n    y = \"Employee size class\",\n    color = NULL,\n  )\n\np2 <- d_est_state_nc_total_size_classes |> \n  mutate(est_size_class = as.character(est_size_class)) |>\n  filter(year == 2021) |>\n  inner_join(n_employees_ref,\n             by = \"est_size_class\") |> \n  mutate(est_size_class = fct_reorder(est_size_class, pct_est)) |>\n  arrange(desc(est_size_class)) |>\n  mutate(cum_pct = cumsum(pct_est),\n         ybar_start = lag(cum_pct, default = 0)) |>\n  ggplot() +\n  geom_segment(aes(x = est_size_class, xend = est_size_class, y = ybar_start, yend = cum_pct),\n           color = carolina_blue, linewidth = 8, alpha = 0.6) + \n  scale_y_continuous(labels = label_percent()) +\n  scale_x_discrete(limits=rev) +\n  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +\n  labs(\n    x = \"Employee size class\",\n    y = \"Percent of establishments\",\n    color = NULL,\n  )\n\np1 + p2 +\n  plot_annotation(\n    title = \"NC establishments in each employee size class\",\n    subtitle = \"2021; includes all sectors reported in CBP\",\n    caption = my_caption\n  )\n\n\n\n\n\nFigure 2.1: NC establishments 2021\n\n\n\n\n\nNC’s distribution of establishments is quite similar to the USA as a whole:\n\n\nShow the code\nnc_naics_abbr_levels <- d_est_sector_total_state_nc |>\n  filter(year == 2021) |>\n  arrange(pct_est) |>\n  pull(naics_abbr)\n\ndata_for_plot <- d_est_sector_total_state_nc |>\n  filter(year == 2021) |>\n  mutate(scope = \"nc\") |>\n  bind_rows(d_est_sector_total_usa |>\n              filter(year == 2021) |>\n              mutate(scope = \"usa\")\n  ) |>\n  select(-c(naics_abbr_num)) |>\n  mutate(naics_abbr = factor(naics_abbr, levels = nc_naics_abbr_levels)) |>\n  mutate(low_value = min(pct_est),\n         high_value = max(pct_est),\n         .by = naics_abbr) |>\n  mutate(diff_pct = high_value - low_value,\n         diff_pct = if_else(pct_est == high_value, diff_pct, -1 * diff_pct)) \n\ndiff_pct_cutoff <- 0.005\n\ndata_for_plot |>\n  ggplot() +\n  geom_segment(aes(x = low_value, xend = high_value, y = naics_abbr, yend = naics_abbr),\n               alpha = 0.3) +\n  geom_point(aes(x = pct_est, y = naics_abbr, color = scope),\n           alpha = 0.6) + \n  geom_point(aes(x = pct_est, y = naics_abbr, color = scope),\n           alpha = 0.6) + \n  geom_text(aes(x = high_value, y = naics_abbr,\n                label = if_else(diff_pct > diff_pct_cutoff,\n                                percent(pct_est, accuracy = .1),\n                                NA_character_)),\n            na.rm = TRUE, size = 3,\n            hjust = 0, nudge_x = 0.003) +\n  geom_text(aes(x = low_value, y = naics_abbr,\n                label = if_else(diff_pct < -1 * diff_pct_cutoff,\n                                percent(pct_est, accuracy = .1),\n                                NA_character_)),\n            na.rm = TRUE, size = 3,\n            hjust = 1, nudge_x = -0.003) +\n  scale_x_continuous(labels = label_percent()) +\n  scale_color_manual(values = c(carolina_blue, \"firebrick\")) +\n  theme(legend.position = c(0.8, 0.4),\n        legend.box.background = element_rect(fill = \"grey80\")) +\n  labs(\n    title = \"NC establishments by sector\\ncompared to USA 2021\",\n    subtitle = glue(\"Includes all 100 counties and 'Statewide'\", \n                    \"; showing percentages where difference is > {percent(diff_pct_cutoff, accuracy = 0.1)}\"),\n    x = \"Establishements\",\n    y = \"\",\n    color = NULL,\n    caption = my_caption\n  )\n\n\n\n\n\nFigure 2.2: NC establishments by sector compared to USA 2021"
  },
  {
    "objectID": "cbp-establishments.html#trends-in-the-number-of-establishements",
    "href": "cbp-establishments.html#trends-in-the-number-of-establishements",
    "title": "2  Establishments",
    "section": "2.3 Trends in the number of establishements",
    "text": "2.3 Trends in the number of establishements\nThe 2008 financial crisis led to a significant drop in the number of construction, real estate, and retail establishments. In most sectors, establishments were able to shed employees during the crisis and stay in business (compare Figure 1.8), presumably due in part to the Paycheck Protection Program and other assistance from Federal1 and state2 governments.\n\n\nShow the code\ndata_for_plot <- d_est_sector_total_state_nc |>\n  filter(naics_abbr != \"OtherInd\") |>\n  mutate(naics_abbr = fct_reorder(naics_abbr, -est)\n         ) |>\n  mutate(est_fist_year = est[year == min(year)],\n         est_last_year = est[year == max(year)],\n         .by = c(\"naics\")) |>\n  mutate(pct_est_diff = est_last_year / est_fist_year - 1)\n\nlabels_for_plot <- data_for_plot |>\n  filter(year == max(year))\n\np1 <- data_for_plot |>\n  filter(naics_abbr != \"Other\") |>\n  ggplot() +\n  geom_line(aes(x = year, y = est, color = naics_abbr, group = naics_abbr),\n           linewidth = 0.4, alpha = 0.6, show.legend = FALSE) +\n  geom_text_repel(data = labels_for_plot,\n                  aes(x = year + 0.5, y = est, label = naics_abbr, color = naics_abbr),\n                  direction = \"y\", hjust = 0, vjust = 0.5, size = 3,\n                  min.segment.length = unit(1, \"cm\"), force_pull = 100,\n                  seed = 123,\n                  show.legend = FALSE) +\n  scale_y_continuous(labels = label_number(scale_cut = cut_short_scale())) +\n  expand_limits(x = 2026,\n                y = 0) +\n  guides(color = guide_legend(override.aes = c(linewidth = 3))) +\n  labs(\n    subtitle = \"NC establishments in each sector\",\n    x = \"\",\n    y = \"Number of establishments\",\n    color = NULL,\n    caption = my_caption\n  )\n\np2 <- data_for_plot |>\n  filter(naics_abbr != \"Other\") |>\n  ggplot() +\n  geom_area(aes(x = year, y = est, color = naics_abbr, fill = naics_abbr, group = naics_abbr),\n           linewidth = 0.4, alpha = 0.6, show.legend = FALSE) +\n  scale_y_continuous(labels = label_number(scale_cut = cut_short_scale()),\n                     expand = expansion(mult = c(0, 0.02))) +\n  expand_limits(#x = 2026,\n                y = 0) +\n  guides(color = guide_legend(override.aes = c(linewidth = 3))) +\n  labs(\n    subtitle = \"NC establishments combined trend\",\n    x = \"\",\n    y = \"Number of establishments\",\n    color = NULL,\n    caption = my_caption\n  )\n\np3 <- data_for_plot |>\n  filter(year == 2021,\n         est != 0) |>\n  ggplot(aes(est, pct_est_diff, color = naics_abbr)) +\n  geom_hline(yintercept = 0, lty = 2, size = 0.2, alpha = 0.2) +\n  geom_label(aes(label = naics_abbr),\n             show.legend = FALSE, hjust = 0.5, vjust = 0.5) +\n  scale_x_continuous(labels = label_number(scale_cut = cut_short_scale())) +\n  scale_y_continuous(labels = label_percent()) +\n  labs(\n    subtitle = glue(\"Percent change in establishments since 2001\"),\n    x = \"Establishments in NC in 2021\",\n    y = \"Pct change since 2001\"\n    )\n\n(p1 + p2) / p3 +\n  plot_annotation(\n    title = \"NC establishments in each sector 2001-2021\",\n    subtitle = \"Includes all sectors reported in CBP\",\n    caption = my_caption\n  )\n\n\n\n\n\nFigure 2.3: NC establishments in each sector 2001-2021\n\n\n\n\n\nHow has the proportion of establishments by employee size class changed over time? In general, the smallest establishments come and go faster than larger establishments.\n\n\nShow the code\ndata_for_plot <- d_est_state_nc_size_classes |>\n  mutate(naics_abbr = fct_lump(naics_abbr, 9, w = value)) |>\n  filter(naics_abbr != \"Other\")\n\ndata_for_plot |>\n  ggplot() +\n  geom_line(aes(x = year, y = pct_est, color = est_size_class, group = est_size_class),\n           linewidth = 0.4, alpha = 0.6) +\n  scale_y_continuous(labels = label_percent(accuracy = 0.1)) +\n  facet_wrap(. ~ naics_abbr, scales = \"free_y\") +\n  guides(color = guide_legend(override.aes = c(linewidth = 3))) +\n  labs(\n    title = \"Percent of NC establishments in each employee size class\\nby sector 2001-2021\",\n    subtitle = \"Top 9 sectors by number of establishments (in 2021) as reported in CBP\",\n    x = \"\",\n    y = \"Percent of establishments (scale varies)\",\n    color = NULL,\n    caption = my_caption\n  )\n\n\n\n\n\nFigure 2.4: Percent of NC establishments by employee size class 2001-2021 for top sectors"
  },
  {
    "objectID": "cbp-establishments.html#table",
    "href": "cbp-establishments.html#table",
    "title": "2  Establishments",
    "section": "2.4 Table",
    "text": "2.4 Table\nSorted by percent difference in number of 2001 to 2021.\n\n\nShow the code\nd_est_sector_total_state_nc |>\n  filter(naics_abbr != \"OtherInd\") |>\n  mutate(naics_abbr = fct_reorder(naics_abbr, -est)\n         ) |>\n  mutate(est_fist_year = est[year == min(year)],\n         est_last_year = est[year == max(year)],\n         .by = c(\"naics\")) |>\n  mutate(pct_est_diff = est_last_year / est_fist_year - 1) |>\n  filter(year == 2021) |>\n  select(naics, naics_abbr, est_2021 = est, pct_est_2021 = pct_est, pct_est_diff_since_2001 = pct_est_diff) |>\n  arrange(-pct_est_diff_since_2001) |>\n  mutate(rowid = row_number()) |>\n  gt() |>\n  tab_header(md(glue(\"**NC sector establishments in 2021 and growth since 2001**\",\n                     \"<br>*Sorted by growth since 2001*\"))) |>\n  tab_source_note(md(\"*US Census County Business Patterns; analysis by Daniel Moul*\")) |>\n  tab_options(table.font.size = 10) |>\n  fmt_number(columns = c(est_2021),\n             decimals = 0) |>\n  fmt_percent(columns = c(pct_est_2021, pct_est_diff_since_2001),\n             decimals = 0)\n\n\n\n\n\n\nTable 2.1:  NC state establishments by sector 2021 \n  \n    \n      NC sector establishments in 2021 and growth since 2001Sorted by growth since 2001\n    \n    \n    \n      naics\n      naics_abbr\n      est_2021\n      pct_est_2021\n      pct_est_diff_since_2001\n      rowid\n    \n  \n  \n    61----\nEduc\n3,269\n1%\n91%\n1\n    53----\nRealEst\n14,743\n6%\n83%\n2\n    22----\nUtil\n648\n0%\n56%\n3\n    62----\nHealthSoc\n25,876\n10%\n54%\n4\n    72----\nAccFood\n22,625\n9%\n49%\n5\n    55----\nMgmt\n1,750\n1%\n48%\n6\n    54----\nProfSciTec\n26,689\n11%\n47%\n7\n    71----\nArtEntRec\n4,228\n2%\n46%\n8\n    48----\nTranspt\n7,661\n3%\n44%\n9\n    56----\nAdminWaste\n14,564\n6%\n38%\n10\n    51----\nInfo\n4,131\n2%\n32%\n11\n    81----\nOtherServ\n25,178\n10%\n18%\n12\n    52----\nFinIns\n13,539\n5%\n17%\n13\n    23----\nConstr\n26,522\n11%\n5%\n14\n    21----\nMineOilGas\n198\n0%\n−2%\n15\n    44----\nRetail\n34,963\n14%\n−3%\n16\n    42----\nWhlsale\n11,266\n5%\n−8%\n17\n    31----\nManuf\n8,537\n3%\n−21%\n18\n    11----\nAgForFish\n793\n0%\n−23%\n19\n  \n  \n    \n      US Census County Business Patterns; analysis by Daniel Moul"
  },
  {
    "objectID": "sector-observations.html#heath-and-social-welfare-healthsoc",
    "href": "sector-observations.html#heath-and-social-welfare-healthsoc",
    "title": "3  Sector observations",
    "section": "3.1 Heath and Social Welfare (HealthSoc)",
    "text": "3.1 Heath and Social Welfare (HealthSoc)\nThis sector grew from third-most employees to first before 2010 and has kept growing since then (Figure 1.8), a 52% increase in employees (Figure 1.8). Average wages grew 17% (Table 1.5)."
  },
  {
    "objectID": "sector-observations.html#retail",
    "href": "sector-observations.html#retail",
    "title": "3  Sector observations",
    "section": "3.2 Retail",
    "text": "3.2 Retail\nThis sector has consistently had the most establishments (Figure 2.3) and has been ranked second or third for most employees (Figure 1.8). However the number of retail establishments has been falling over these 20 years (Figure 2.3) primarily among the smallest establishments (Figure 2.4), and wages have been second or third from the bottom, presumably due in part to a large portion of the workers being part-time."
  },
  {
    "objectID": "sector-observations.html#accomodation-and-food-accfood",
    "href": "sector-observations.html#accomodation-and-food-accfood",
    "title": "3  Sector observations",
    "section": "3.3 Accomodation and Food (AccFood)",
    "text": "3.3 Accomodation and Food (AccFood)\nSimilarly, this sector has consistently had the most establishments (Figure 2.3) and has been ranked second or third for most employees (Figure 1.8). However wages have been at the bottom, presumably due in part to a large portion being part-time workers. This sector also saw the largest impact of the COVID-19 pandemic as people stopped eating at restaurants and traveling (Figure 1.8, Figure 1.9, Figure 2.4). Over two decades this sector has seen steady growth in employment–faster than Retail (Figure 1.10)."
  },
  {
    "objectID": "sector-observations.html#manufacturing-manuf",
    "href": "sector-observations.html#manufacturing-manuf",
    "title": "3  Sector observations",
    "section": "3.4 Manufacturing (Manuf)",
    "text": "3.4 Manufacturing (Manuf)\nThe loss of nearly a third of manufacturing jobs in the years 2001-2011 (Figure 1.8) was the tail end of wrenching dislocations as small and medium-sized businesses lost out to foreign competition, notably in furniture and textiles. The loss was steepest in establishments with 100 or more employees. Smaller establishments have continued to disappear but at a slower and more consistent rate. The turnaround in later years is therefore very encouraging (Figure 1.10) however (A) the new growth didn’t necessarily take place in the same counties; some of the growth is visible in the largest counties: Forsyth, Durham, Catawba, and Buncombe (Figure 1.14); and (B) the growth occurred only in large establishments with 500 or more employees. I infer the continued loss of local companies, and the growth coming from national and international companies establishing plants in NC. Employment is down 35% (Table 1.3), which is the largest loss of any sector. Establishments are down 21% (Table 2.1)."
  },
  {
    "objectID": "sector-observations.html#finance-and-insurance-finins",
    "href": "sector-observations.html#finance-and-insurance-finins",
    "title": "3  Sector observations",
    "section": "3.5 Finance and Insurance (FinIns)",
    "text": "3.5 Finance and Insurance (FinIns)\nThis sector took a hit during and after the financial crisis of 2008+ in employment (Figure 1.8), especially among the smallest establishments (Figure 2.4), but interestingly average wages were not impacted (Figure 1.16). This sector has seen 67% average wage growth over 20 years (Table 1.5), second only to Info (Figure 1.16)."
  },
  {
    "objectID": "sector-observations.html#information-info",
    "href": "sector-observations.html#information-info",
    "title": "3  Sector observations",
    "section": "3.6 Information (Info)",
    "text": "3.6 Information (Info)\nAs the US and NC economy has transitioned to more of an information economy this sector has benefited greatly. Wages are up 68% in real terms over 20 years (Figure 1.16, Table 1.5) while employment is up 8% as well (Figure 1.8). It seems to me employment growth has been higher than this. Perhaps the short life of many high-tech companies creates churn without a lot of net growth, and outsourcing to less expensive countries has taken a toll."
  },
  {
    "objectID": "sector-observations.html#professional-scientific-technical-profscitec",
    "href": "sector-observations.html#professional-scientific-technical-profscitec",
    "title": "3  Sector observations",
    "section": "3.7 Professional, Scientific, Technical (ProfSciTec)",
    "text": "3.7 Professional, Scientific, Technical (ProfSciTec)\nThe number of employees in this sector has continued to grow: 55% since 2001 (Figure 1.8). This occurred despite the number of very small establishments growing quickly in the first decade then leveling off (Figure 2.4) and resulting in 47% growth in establishments (Table 2.1). Average wages grew 32% over this time period in line with many other sectors Figure 1.16, Table 1.5)."
  },
  {
    "objectID": "sector-observations.html#education-educ",
    "href": "sector-observations.html#education-educ",
    "title": "3  Sector observations",
    "section": "3.8 Education (Educ)",
    "text": "3.8 Education (Educ)\nThe number of education establishments increased 91% from a small base in 2001 to 3,269 in 2021 (Table 2.1) and employment incresed 46% (Table 1.3). I assume this growth is due to charter schools. Are public schools considered “public administration” and thus excluded from the CBP? I haven’t looked closely enough to be sure."
  },
  {
    "objectID": "sector-observations.html#statewide",
    "href": "sector-observations.html#statewide",
    "title": "3  Sector observations",
    "section": "3.9 Statewide",
    "text": "3.9 Statewide\nEmployees not associated with a county are counted in the “Statewide” category. This category has been growing and is concentrated in the AdminWaste sector (likely the “Admin” portion) (Figure 1.14)."
  },
  {
    "objectID": "notes.html#introduction",
    "href": "notes.html#introduction",
    "title": "4  Notes",
    "section": "4.1 Introduction",
    "text": "4.1 Introduction\nI learned about this data from Jeremy Singer-Vines’ Data Is Plural 2023.05.31 edition\n\nLocal business. Despite the name, the Census Bureau’s County Business Patterns datasets cover a range of geographic units, including states, congressional districts, metro areas, counties, and ZIP codes. Generated from the Bureau’s confidential Business Register, they provide the number of establishments and (noise-infused) employee counts and payroll figures, disaggregated by industry code. Last month, the Bureau released the data for 2021. Historical availability varies; the Bureau directly provides data for counties back to 1986, and for ZIP codes back to 1994, for example. Fabian Eckert and colleagues, meanwhile, have converted two older archives of the records into comparable data, spanning 1946 to 1974 and 1975 onward.\n\nFor an overview see https://www.census.gov/programs-surveys/cbp.html"
  },
  {
    "objectID": "notes.html#sources-and-reference-files",
    "href": "notes.html#sources-and-reference-files",
    "title": "4  Notes",
    "section": "4.2 Sources and reference files",
    "text": "4.2 Sources and reference files\nI downloaded data from https://www.census.gov/data/datasets/2021/econ/cbp/2021-cbp.html on 2023-06-04. Specifically: Complete County File [102.9 MB] https://www2.census.gov/programs-surveys/cbp/datasets/2021/cbp21co.zip and all years from 2001 onward.\nThe CSV files are like this:\n% cat cbp21co.txt | head\n\"fipstate\",\"fipscty\",\"naics\",\"emp_nf\",\"emp\",\"qp1_nf\",\"qp1\",\"ap_nf\",\"ap\",\"est\",\"n<5\",\"n5_9\",\"n10_19\",\"n20_49\",\"n50_99\",\"n100_249\",\"n250_499\",\"n500_999\",\"n1000\",\"n1000_1\",\"n1000_2\",\"n1000_3\",\"n1000_4\"\n\"01\",\"001\",\"------\",\"G\",11216,\"G\",97944,\"G\",424826,924,442,222,118,100,31,8,\"N\",\"N\",\"N\",\"N\",\"N\",\"N\",\"N\"\n\"01\",\"001\",\"11----\",\"G\",78,\"G\",1325,\"G\",5107,10,9,\"N\",\"N\",\"N\",\"N\",\"N\",\"N\",\"N\",\"N\",\"N\",\"N\",\"N\",\"N\"\n\"01\",\"001\",\"113///\",\"G\",68,\"G\",1213,\"G\",4563,7,6,\"N\",\"N\",\"N\",\"N\",\"N\",\"N\",\"N\",\"N\",\"N\",\"N\",\"N\",\"N\"\n\"01\",\"001\",\"1133//\",\"G\",68,\"G\",1213,\"G\",4563,7,6,\"N\",\"N\",\"N\",\"N\",\"N\",\"N\",\"N\",\"N\",\"N\",\"N\",\"N\",\"N\"\n\"01\",\"001\",\"11331/\",\"G\",68,\"G\",1213,\"G\",4563,7,6,\"N\",\"N\",\"N\",\"N\",\"N\",\"N\",\"N\",\"N\",\"N\",\"N\",\"N\",\"N\"\n\"01\",\"001\",\"113310\",\"G\",68,\"G\",1213,\"G\",4563,7,6,\"N\",\"N\",\"N\",\"N\",\"N\",\"N\",\"N\",\"N\",\"N\",\"N\",\"N\",\"N\"\n\"01\",\"001\",\"115///\",\"J\",10,\"J\",112,\"J\",544,3,3,\"N\",\"N\",\"N\",\"N\",\"N\",\"N\",\"N\",\"N\",\"N\",\"N\",\"N\",\"N\"\n\"01\",\"001\",\"21----\",\"G\",87,\"G\",1224,\"G\",5144,6,\"N\",\"N\",\"N\",\"N\",\"N\",\"N\",\"N\",\"N\",\"N\",\"N\",\"N\",\"N\",\"N\"\n\"01\",\"001\",\"212///\",\"G\",87,\"G\",1224,\"G\",5144,6,\"N\",\"N\",\"N\",\"N\",\"N\",\"N\",\"N\",\"N\",\"N\",\"N\",\"N\",\"N\",\"N\"\n\n\nCounty Record Layout [<1.0 MB] https://www2.census.gov/programs-surveys/cbp/technical-documentation/records-layouts/2020_record_layouts/county-layout-2020.txt\n                CBP[YR]CO.TXT\n\n                                County Data Dictionary                                \n\nNote:  In the filenames, [YR] is the 2-digit data year.  Each data field is separated by comma (,) delimiters.\n\n\nField           Data  \nName            Type    Description\n\nFIPSTATE        C       FIPS State Code\n\nFIPSCTY         C       FIPS County Code\n\nNAICS           C       Industry Code - 6-digit NAICS code.\n\nEMP_NF          C       Total Mid-March Employees Noise Flag (See all Noise Flag definitions at the end of this record \n                        layout)\n\nEMP             N       Total Mid-March Employees with Noise\n\nQP1_NF          C       Total First Quarter Payroll Noise Flag\n\nQP1             N       Total First Quarter Payroll ($1,000) with Noise\n                                                              \nAP_NF           C       Total Annual Payroll Noise Flag\n\nAP              N       Total Annual Payroll ($1,000) with Noise\n\nEST             N       Total Number of Establishments\n\nN<5             N       Number of Establishments: Less than 5 Employee Size Class\n\nN5_9            N       Number of Establishments: 5-9 Employee Size Class\n\nN10_19          N       Number of Establishments: 10-19 Employee Size Class\n\nN20_49          N       Number of Establishments: 20-49 Employee Size Class\n\nN50_99          N       Number of Establishments: 50-99 Employee Size Class\n\nN100_249        N       Number of Establishments: 100-249 Employee Size Class\n\nN250_499        N       Number of Establishments: 250-499 Employee Size Class\n\nN500_999        N       Number of Establishments: 500-999 Employee Size Class\n\nN1000           N       Number of Establishments: 1,000 or More Employee Size Class\n\nN1000_1         N       Number of Establishments: Employment Size Class:\n                                1,000-1,499 Employees\n\nN1000_2         N       Number of Establishments: Employment Size Class:\n                                1,500-2,499 Employees\n\nN1000_3         N       Number of Establishments: Employment Size Class:\n                                2,500-4,999 Employees\n\nN1000_4         N       Number of Establishments: Employment Size Class:\n                                5,000 or More Employees\n\n\nNOTE: Noise Flag definitions (fields ending in _NF) are:\n\n        G       0 to < 2% noise (low noise)\n        H       2 to < 5% noise (medium noise)\n    J   >= 5% noise (high noise)\n\n      Flag definition for Establishment by Employment Size Class fields (N<5, N5_9, etc.):\n    \n    N   Not available or not comparable\n\n\nNorth American Industry Classification System (NAICS) Descriptions [<1.0 MB] https://www2.census.gov/programs-surveys/cbp/technical-documentation/reference/naics-descriptions/naics2017.txt\n\"NAICS\",\"DESCRIPTION\"\n\"------\",\"Total for all sectors\"\n\"11----\",\"Agriculture, Forestry, Fishing and Hunting\"\n\"113///\",\"Forestry and Logging\"\n\"1131//\",\"Timber Tract Operations\"\n\"11311/\",\"Timber Tract Operations\"\n\"113110\",\"Timber Tract Operations\"\n\"1132//\",\"Forest Nurseries and Gathering of Forest Products\"\n\"11321/\",\"Forest Nurseries and Gathering of Forest Products\"\n\"113210\",\"Forest Nurseries and Gathering of Forest Products\"\n\"1133//\",\"Logging\"\n\"11331/\",\"Logging\"\n\"113310\",\"Logging\"\n\"114///\",\"Fishing, Hunting and Trapping\"\n\"1141//\",\"Fishing\"\n\"11411/\",\"Fishing\"\n\"114111\",\"Finfish Fishing\"\n\"114112\",\"Shellfish Fishing\"\n\"114119\",\"Other Marine Fishing\"\n\"1142//\",\"Hunting and Trapping\"\n\"11421/\",\"Hunting and Trapping\"\n\"114210\",\"Hunting and Trapping\"\n\n\nState and County Geography Reference [<1.0 MB] https://www2.census.gov/programs-surveys/cbp/technical-documentation/reference/state-county-geography-reference/georef17.txt\nNote: NC FIPS state code is “37”\n\"st\",\"cty\",\"ctyname\"\n\"01\",\"001\",\"Autauga County, Alabama\"\n\"01\",\"003\",\"Baldwin County, Alabama\"\n\"01\",\"005\",\"Barbour County, Alabama\"\n\"01\",\"007\",\"Bibb County, Alabama\"\n\"01\",\"009\",\"Blount County, Alabama\"\n\n\nThe categories and codes changed a lot over the decades. I considered using Ekert et al.’s method1 to deal with this (and I made an attempt). However I found it difficult to be sure I was implementing the method correctly, so I limited my usage to sector totals to minimize the impact of changing categories… as well as limiting myself to data starting in 2001 by which time the categories and codes were much more stable."
  }
]